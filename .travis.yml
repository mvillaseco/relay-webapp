language: node_js
node_js:
  - "6"
env:
  - NODE_ENV=development
# Cache yarn dependencies  
cache:
  yarn: true
  directories:
    - node_modules
    - bower_components
before_install:
  # Before starting the build go to the subfolder where code was placed
  - cd src
before_script:
  # Install global dependencies
  - npm list -g gulp --depth=0 || npm install -g gulp
  - npm list -g bower --depth=0 || npm install -g bower
  # Install dependencies
  - yarn
  # Setup browsers
  - export CHROME_BIN=chromium-browser
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - node ./node_modules/protractor/bin/webdriver-manager update
script:
  # Exec tests
  - gulp test